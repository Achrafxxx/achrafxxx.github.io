(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"74Do":function(t,e,s){"use strict";s.d(e,"a",(function(){return n}));var r=s("G5s2"),a=s("fXoL");let n=(()=>{class t extends r.b{constructor(t){super("Order",t)}}return t.\u0275fac=function(e){return new(e||t)(a.gc(r.c))},t.\u0275prov=a.Ob({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},"8ikL":function(t,e,s){"use strict";s.d(e,"a",(function(){return n}));var r=s("G5s2"),a=s("fXoL");let n=(()=>{class t extends r.b{constructor(t){super("Company",t)}}return t.\u0275fac=function(e){return new(e||t)(a.gc(r.c))},t.\u0275prov=a.Ob({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},G5s2:function(t,e,s){"use strict";s.d(e,"a",(function(){return Z})),s.d(e,"b",(function(){return Ct})),s.d(e,"c",(function(){return kt})),s.d(e,"d",(function(){return Qt})),s.d(e,"e",(function(){return J})),s.d(e,"f",(function(){return z}));var r=s("fXoL"),a=s("pLZG"),n=s("lJxs"),i=s("3E0/"),c=s("tS1D"),o=s("JIr8"),h=s("UXun"),d=s("IzEk"),l=s("5+tZ"),u=s("zp1y"),y=s("bOdf"),g=s("tk/3"),p=s("z6cu"),O=s("LRne"),m=s("Nv8m"),f=s("D0XW"),b=s("VRyK"),v=s("kt0X");const S=function(){var t={EntitiesOnly:0,Both:1,None:2};return t[t.EntitiesOnly]="EntitiesOnly",t[t.Both]="Both",t[t.None]="None",t}();function j(t){return function(e,s){const r={ids:[...s.ids],entities:Object.assign({},s.entities)},a=t(e,r);return a===S.Both?Object.assign({},s,r):a===S.EntitiesOnly?Object.assign(Object.assign({},s),{entities:r.entities}):s}}function C(t,e){const s=e(t);return Object(r.Y)()&&void 0===s&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",t,"The `selectId` implementation:",e.toString()),s}function E(t){function e(e,s){const r=C(e,t);return r in s.entities?S.None:(s.ids.push(r),s.entities[r]=e,S.Both)}function s(t,s){let r=!1;for(const a of t)r=e(a,s)!==S.None||r;return r?S.Both:S.None}function r(t,e){return e.ids=[],e.entities={},s(t,e),S.Both}function a(t,e){const s=(t instanceof Array?t:e.ids.filter(s=>t(e.entities[s]))).filter(t=>t in e.entities).map(t=>delete e.entities[t]).length>0;return s&&(e.ids=e.ids.filter(t=>t in e.entities)),s?S.Both:S.None}function n(e,s){const r={};return(e=e.filter(t=>t.id in s.entities)).length>0?e.filter(e=>function(e,s,r){const a=Object.assign({},r.entities[s.id],s.changes),n=C(a,t),i=n!==s.id;return i&&(e[s.id]=n,delete r.entities[s.id]),r.entities[n]=a,i}(r,e,s)).length>0?(s.ids=s.ids.map(t=>r[t]||t),S.Both):S.EntitiesOnly:S.None}function i(e,r){const a=[],i=[];for(const s of e){const e=C(s,t);e in r.entities?i.push({id:e,changes:s}):a.push(s)}const c=n(i,r),o=s(a,r);switch(!0){case o===S.None&&c===S.None:return S.None;case o===S.Both||c===S.Both:return S.Both;default:return S.EntitiesOnly}}return{removeAll:function(t){return Object.assign({},t,{ids:[],entities:{}})},addOne:j(e),addMany:j(s),addAll:j(r),setAll:j(r),setOne:j((function(e,s){const r=C(e,t);return r in s.entities?(s.entities[r]=e,S.EntitiesOnly):(s.ids.push(r),s.entities[r]=e,S.Both)})),updateOne:j((function(t,e){return n([t],e)})),updateMany:j(n),upsertOne:j((function(t,e){return i([t],e)})),upsertMany:j(i),removeOne:j((function(t,e){return a([t],e)})),removeMany:j(a),map:j((function(t,e){return n(e.ids.reduce((s,r)=>{const a=t(e.entities[r]);return a!==e.entities[r]&&s.push({id:r,changes:a}),s},[]).filter(({id:t})=>t in e.entities),e)}))}}var x=s("snw9");let A=(()=>{class t{create(t,e,s,r){const a="string"==typeof t?Object.assign(Object.assign({},r||{}),{entityName:t,entityOp:e,data:s}):t;return this.createCore(a)}createCore(t){const{entityName:e,entityOp:s,tag:r}=t;if(!e)throw new Error("Missing entity name for new action");if(null==s)throw new Error("Missing EntityOp for new action");return{type:this.formatActionType(s,r||e),payload:t}}createFromAction(t,e){return this.create(Object.assign(Object.assign({},t.payload),e))}formatActionType(t,e){return`[${e}] ${t}`}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})();class k{constructor(t,e){this.entityName=t,this.selectId=e}mustBeEntity(t){const e=this.extractData(t);if(!e)return this.throwError(t,"should have a single entity.");const s=this.selectId(e);return this.isNotKeyType(s)&&this.throwError(t,"has a missing or invalid entity key (id)"),e}mustBeEntities(t){const e=this.extractData(t);return Array.isArray(e)?(e.forEach((e,s)=>{const r=this.selectId(e);this.isNotKeyType(r)&&this.throwError(t,`, item ${s+1}, does not have a valid entity key (id)`)}),e):this.throwError(t,"should be an array of entities")}mustBeKey(t){const e=this.extractData(t);if(!e)throw new Error("should be a single entity key");if(this.isNotKeyType(e))throw new Error("is not a valid key (id)");return e}mustBeKeys(t){const e=this.extractData(t);return Array.isArray(e)?(e.forEach((e,s)=>{this.isNotKeyType(e)&&this.throwError(t,`${this.entityName} ', item ${s+1}, is not a valid entity key (id)`)}),e):this.throwError(t,"should be an array of entity keys (id)")}mustBeUpdate(t){const e=this.extractData(t);if(!e)return this.throwError(t,"should be a single entity update");const{id:s,changes:r}=e,a=this.selectId(r);return(this.isNotKeyType(s)||this.isNotKeyType(a))&&this.throwError(t,"has a missing or invalid entity key (id)"),e}mustBeUpdates(t){const e=this.extractData(t);return Array.isArray(e)?(e.forEach((e,s)=>{const{id:r,changes:a}=e,n=this.selectId(a);(this.isNotKeyType(r)||this.isNotKeyType(n))&&this.throwError(t,`, item ${s+1}, has a missing or invalid entity key (id)`)}),e):this.throwError(t,"should be an array of entity updates")}mustBeUpdateResponse(t){const e=this.extractData(t);if(!e)return this.throwError(t,"should be a single entity update");const{id:s,changes:r}=e,a=this.selectId(r);return(this.isNotKeyType(s)||this.isNotKeyType(a))&&this.throwError(t,"has a missing or invalid entity key (id)"),e}mustBeUpdateResponses(t){const e=this.extractData(t);return Array.isArray(e)?(e.forEach((e,s)=>{const{id:r,changes:a}=e,n=this.selectId(a);(this.isNotKeyType(r)||this.isNotKeyType(n))&&this.throwError(t,`, item ${s+1}, has a missing or invalid entity key (id)`)}),e):this.throwError(t,"should be an array of entity updates")}extractData(t){return t.payload&&t.payload.data}isNotKeyType(t){return"string"!=typeof t&&"number"!=typeof t}throwError(t,e){throw new Error(`${this.entityName} EntityAction guard for "${t.type}": payload ${e}`)}}function D(t){return null==t?void 0:t.id}function M(t){if(null==t)return[];if(Array.isArray(t[0])){const[e,...s]=t;t=[...e,...s]}return t}function w(t){return t=t||D,function(e){const s=t(e);if(null==s)throw new Error("Primary key may not be null/undefined.");return e&&{id:s,changes:e}}}function U(...t){const e=M(t);switch(e.length){case 0:return Object(a.a)(t=>t.payload&&null!=t.payload.entityOp);case 1:const t=e[0];return Object(a.a)(e=>e.payload&&t===e.payload.entityOp);default:return Object(a.a)(t=>{const s=t.payload&&t.payload.entityOp;return s&&e.some(t=>t===s)})}}function I(...t){const e=M(t);switch(e.length){case 0:return Object(a.a)(t=>t.payload&&null!=t.payload.entityName);case 1:const t=e[0];return Object(a.a)(e=>e.payload&&t===e.payload.entityName);default:return Object(a.a)(t=>{const s=t.payload&&t.payload.entityName;return!!s&&e.some(t=>t===s)})}}function $(t){const e=(t=t&&t.changes?t:{changes:[]}).changes.filter(t=>null!=t&&t.entities&&t.entities.length>0);return Object.assign(Object.assign({},t),{changes:e})}const T=function(){var t={IgnoreChanges:0,PreserveChanges:1,OverwriteChanges:2};return t[t.IgnoreChanges]="IgnoreChanges",t[t.PreserveChanges]="PreserveChanges",t[t.OverwriteChanges]="OverwriteChanges",t}();class N{constructor(t,e){this.type="@ngrx/data/entity-cache/clear-collections",this.payload={collections:t,tag:e}}}class R{constructor(t,e){this.type="@ngrx/data/entity-cache/load-collections",this.payload={collections:t,tag:e}}}class F{constructor(t,e,s){this.type="@ngrx/data/entity-cache/merge-query-set",this.payload={querySet:t,mergeStrategy:null===e?T.PreserveChanges:e,tag:s}}}class L{constructor(t,e){this.cache=t,this.type="@ngrx/data/entity-cache/set-cache",this.payload={cache:t,tag:e}}}class B{constructor(t,e,s){this.type="@ngrx/data/entity-cache/save-entities",s=s||{},t&&(t.tag=t.tag||s.tag),this.payload=Object.assign(Object.assign({changeSet:t,url:e},s),{tag:t.tag})}}class q{constructor(t,e,s,r){this.type="@ngrx/data/entity-cache/save-entities-cancel",this.payload={correlationId:t,reason:e,entityNames:s,tag:r}}}class K{constructor(t,e,s){this.type="@ngrx/data/entity-cache/save-entities-cancel",this.payload={correlationId:t,reason:e,tag:s}}}class P{constructor(t,e){this.type="@ngrx/data/entity-cache/save-entities-error",this.payload={error:t,originalAction:e,correlationId:e.payload.correlationId}}}class Q{constructor(t,e,s){this.type="@ngrx/data/entity-cache/save-entities-success",s=s||{},t&&(t.tag=t.tag||s.tag),this.payload=Object.assign(Object.assign({changeSet:t,url:e},s),{tag:t.tag})}}function G(t){return t+"/success"}class V{constructor(t,e){this.error=t,this.requestData=e,this.message="string"==typeof t?t:function(t){const{error:e,body:s,message:r}=t;let a=null;return e?a="string"==typeof e?e:e.message:r?a=r:s&&(a="string"==typeof s?s:s.error),"string"==typeof a?a:a?JSON.stringify(a):null}(t)}}class H{}class W{}const X=new r.r("@ngrx/data/plural-names");class z{}class J{}let Z=(()=>{class t{constructor(t){this.pluralizer=t,this.knownHttpResourceUrls={}}getResourceUrls(t,e){let s=this.knownHttpResourceUrls[t];if(!s){const r=function(t){return t.replace(/^[\/\s]+|[\/\s]+$/g,"")}(e);s={entityResourceUrl:`${r}/${t}/`.toLowerCase(),collectionResourceUrl:`${r}/${this.pluralizer.pluralize(t)}/`.toLowerCase()},this.registerHttpResourceUrls({[t]:s})}return s}entityResource(t,e){return this.getResourceUrls(t,e).entityResourceUrl}collectionResource(t,e){return this.getResourceUrls(t,e).collectionResourceUrl}registerHttpResourceUrls(t){this.knownHttpResourceUrls=Object.assign(Object.assign({},this.knownHttpResourceUrls),t||{})}}return t.\u0275fac=function(e){return new(e||t)(r.gc(z))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})();class Y{constructor(t,e,s,r){this.http=e,this.httpUrlGenerator=s,this.getDelay=0,this.saveDelay=0,this.timeout=0,this._name=t+" DefaultDataService",this.entityName=t;const{root:a="api",delete404OK:n=!0,getDelay:i=0,saveDelay:c=0,timeout:o=0}=r||{};this.delete404OK=n,this.entityUrl=s.entityResource(t,a),this.entitiesUrl=s.collectionResource(t,a),this.getDelay=i,this.saveDelay=c,this.timeout=o}get name(){return this._name}add(t){const e=t||new Error(`No "${this.entityName}" entity to add`);return this.execute("POST",this.entityUrl,e)}delete(t){let e;return null==t&&(e=new Error(`No "${this.entityName}" key to delete`)),this.execute("DELETE",this.entityUrl+t,e).pipe(Object(n.a)(e=>t))}getAll(){return this.execute("GET",this.entitiesUrl)}getById(t){let e;return null==t&&(e=new Error(`No "${this.entityName}" key to get`)),this.execute("GET",this.entityUrl+t,e)}getWithQuery(t){const e=new g.e("string"==typeof t?{fromString:t}:{fromObject:t});return this.execute("GET",this.entitiesUrl,void 0,{params:e})}update(t){const e=t&&t.id,s=null==e?new Error(`No "${this.entityName}" update data or id`):t.changes;return this.execute("PUT",this.entityUrl+e,s)}upsert(t){const e=t||new Error(`No "${this.entityName}" entity to upsert`);return this.execute("POST",this.entityUrl,e)}execute(t,e,s,r){const a={method:t,url:e,data:s,options:r};if(s instanceof Error)return this.handleError(a)(s);let n;switch(t){case"DELETE":n=this.http.delete(e,r),this.saveDelay&&(n=n.pipe(Object(i.a)(this.saveDelay)));break;case"GET":n=this.http.get(e,r),this.getDelay&&(n=n.pipe(Object(i.a)(this.getDelay)));break;case"POST":n=this.http.post(e,s,r),this.saveDelay&&(n=n.pipe(Object(i.a)(this.saveDelay)));break;case"PUT":n=this.http.put(e,s,r),this.saveDelay&&(n=n.pipe(Object(i.a)(this.saveDelay)));break;default:{const e=new Error("Unimplemented HTTP method, "+t);n=Object(p.a)(e)}}return this.timeout&&(n=n.pipe(Object(c.a)(this.timeout+this.saveDelay))),n.pipe(Object(o.a)(this.handleError(a)))}handleError(t){return e=>{const s=this.handleDelete404(e,t);if(s)return s;const r=new V(e,t);return Object(p.a)(r)}}handleDelete404(t,e){if(404===t.status&&"DELETE"===e.method&&this.delete404OK)return Object(O.a)({})}}let _=(()=>{class t{constructor(t,e,s){this.http=t,this.httpUrlGenerator=e,this.config=s,e.registerHttpResourceUrls((s=s||{}).entityHttpResourceUrls)}create(t){return new Y(t,this.http,this.httpUrlGenerator,this.config)}}return t.\u0275fac=function(e){return new(e||t)(r.gc(g.b),r.gc(J),r.gc(H,8))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})();const tt=new r.r("@ngrx/data/entity-metadata");let et=(()=>{class t{constructor(t){this.definitions={},t&&t.forEach(t=>this.registerMetadataMap(t))}getDefinition(t,e=!0){t=t.trim();const s=this.definitions[t];if(!s&&e)throw new Error(`No EntityDefinition for entity type "${t}".`);return s}registerMetadata(t){if(t){const e=function(t){let e=t.entityName;if(!e)throw new Error("Missing required entityName");t.entityName=e=e.trim();const s=t.selectId||D,r=t.sortComparer=t.sortComparer||!1,a=function(t={}){const{selectId:e,sortComparer:s}=Object.assign({sortComparer:!1,selectId:t=>t.id},t),r={getInitialState:function(t={}){return Object.assign({ids:[],entities:{}},t)}},a={getSelectors:function(t){const e=t=>t.ids,s=t=>t.entities,r=Object(v.s)(e,s,(t,e)=>t.map(t=>e[t])),a=Object(v.s)(e,t=>t.length);return t?{selectIds:Object(v.s)(t,e),selectEntities:Object(v.s)(t,s),selectAll:Object(v.s)(t,r),selectTotal:Object(v.s)(t,a)}:{selectIds:e,selectEntities:s,selectAll:r,selectTotal:a}}},n=s?function(t,e){const{removeOne:s,removeMany:r,removeAll:a}=E(t);function n(t,e){return i([t],e)}function i(e,s){const r=e.filter(e=>!(C(e,t)in s.entities));return 0===r.length?S.None:(d(r,s),S.Both)}function c(t,e){return e.entities={},e.ids=[],i(t,e),S.Both}function o(e,s){const r=[],a=e.filter(e=>function(e,s,r){if(!(s.id in r.entities))return!1;const a=Object.assign({},r.entities[s.id],s.changes),n=C(a,t);return delete r.entities[s.id],e.push(a),n!==s.id}(r,e,s)).length>0;if(0===r.length)return S.None;{const t=s.ids,e=[];return s.ids=s.ids.filter((t,r)=>t in s.entities||(e.push(r),!1)),d(r,s),!a&&e.every(e=>s.ids[e]===t[e])?S.EntitiesOnly:S.Both}}function h(e,s){const r=[],a=[];for(const i of e){const e=C(i,t);e in s.entities?a.push({id:e,changes:i}):r.push(i)}const n=o(a,s),c=i(r,s);switch(!0){case c===S.None&&n===S.None:return S.None;case c===S.Both||n===S.Both:return S.Both;default:return S.EntitiesOnly}}function d(s,r){s.sort(e);const a=[];let n=0,i=0;for(;n<s.length&&i<r.ids.length;){const c=s[n],o=C(c,t),h=r.ids[i];e(c,r.entities[h])<=0?(a.push(o),n++):(a.push(h),i++)}r.ids=a.concat(n<s.length?s.slice(n).map(t):r.ids.slice(i)),s.forEach((e,s)=>{r.entities[t(e)]=e})}return{removeOne:s,removeMany:r,removeAll:a,addOne:j(n),updateOne:j((function(t,e){return o([t],e)})),upsertOne:j((function(t,e){return h([t],e)})),addAll:j(c),setAll:j(c),setOne:j((function(e,s){const r=C(e,t);return r in s.entities?(s.ids=s.ids.filter(t=>t!==r),d([e],s),S.Both):n(e,s)})),addMany:j(i),updateMany:j(o),upsertMany:j(h),map:j((function(t,e){return o(e.ids.reduce((s,r)=>{const a=t(e.entities[r]);return a!==e.entities[r]&&s.push({id:r,changes:a}),s},[]),e)}))}}(e,s):E(e);return Object.assign(Object.assign(Object.assign({selectId:e,sortComparer:s},r),a),n)}({selectId:s,sortComparer:r}),n=t.entityDispatcherOptions||{},i=a.getInitialState(Object.assign({entityName:e,filter:"",loaded:!1,loading:!1,changeState:{}},t.additionalCollectionState||{}));return{entityName:e,entityAdapter:a,entityDispatcherOptions:n,initialState:i,metadata:t,noChangeTracking:!0===t.noChangeTracking,selectId:s,sortComparer:r}}(t);this.registerDefinition(e)}}registerMetadataMap(t={}){Object.keys(t||{}).forEach(e=>this.registerMetadata(Object.assign({entityName:e},t[e])))}registerDefinition(t){this.definitions[t.entityName]=t}registerDefinitions(t){Object.assign(this.definitions,t)}}return t.\u0275fac=function(e){return new(e||t)(r.gc(tt,8))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})(),st=(()=>{class t{constructor(t,e,s){this.entityDefinitionService=t,this.http=e,this.idSelectors={},this.saveDelay=0,this.timeout=0;const{saveDelay:r=0,timeout:a=0}=s||{};this.saveDelay=r,this.timeout=a}saveEntities(t,e){t=this.filterChangeSet(t),t=this.flattenUpdates(t);let s=this.http.post(e,t).pipe(Object(n.a)(t=>this.restoreUpdates(t)),Object(o.a)(this.handleError({method:"POST",url:e,data:t})));return this.timeout&&(s=s.pipe(Object(c.a)(this.timeout))),this.saveDelay&&(s=s.pipe(Object(i.a)(this.saveDelay))),s}handleError(t){return e=>{const s=new V(e,t);return Object(p.a)(s)}}filterChangeSet(t){return $(t)}flattenUpdates(t){let e=t.changes;if(0===e.length)return t;let s=!1;return e=e.map(t=>"Update"===t.op&&t.entities.length>0?(s=!0,Object.assign(Object.assign({},t),{entities:t.entities.map(t=>t.changes)})):t),s?Object.assign(Object.assign({},t),{changes:e}):t}restoreUpdates(t){if(null==t)return t;let e=t.changes;if(0===e.length)return t;let s=!1;return e=e.map(t=>{if("Update"===t.op){s=!0;const e=this.getIdSelector(t.entityName);return Object.assign(Object.assign({},t),{entities:t.entities.map(t=>({id:e(t),changes:t}))})}return t}),s?Object.assign(Object.assign({},t),{changes:e}):t}getIdSelector(t){let e=this.idSelectors[t];return e||(e=this.entityDefinitionService.getDefinition(t).selectId,this.idSelectors[t]=e),e}}return t.\u0275fac=function(e){return new(e||t)(r.gc(et),r.gc(g.b),r.gc(H,8))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})(),rt=(()=>{class t{constructor(t){this.defaultDataServiceFactory=t,this.services={}}getService(t){t=t.trim();let e=this.services[t];return e||(e=this.defaultDataServiceFactory.create(t),this.services[t]=e),e}registerService(t,e){this.services[t.trim()]=e}registerServices(t){this.services=Object.assign(Object.assign({},this.services),t)}}return t.\u0275fac=function(e){return new(e||t)(r.gc(_))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})();class at{}let nt=(()=>{class t{constructor(t,e){this.logger=t,this.entityActionFactory=e}handleSuccess(t){const e=G(t.payload.entityOp);return s=>this.entityActionFactory.createFromAction(t,{entityOp:e,data:s})}handleError(t){const e=t.payload.entityOp+"/error";return s=>{const r={error:s instanceof V?s:new V(s,null),originalAction:t};return this.logger.error(r),this.entityActionFactory.createFromAction(t,{entityOp:e,data:r})}}}return t.\u0275fac=function(e){return new(e||t)(r.gc(W),r.gc(A))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})(),it=(()=>{class t{constructor(){this.seed=0,this.prefix="CRID"}next(){return this.seed+=1,this.prefix+this.seed}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})(),ct=(()=>{class t{constructor(){this.optimisticAdd=!1,this.optimisticDelete=!0,this.optimisticUpdate=!1,this.optimisticUpsert=!1,this.optimisticSaveEntities=!1}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})();class ot{constructor(t){this.message=t,this.message=t||"Canceled by user"}}let ht=(()=>{class t{constructor(t,e,s,r){this.correlationIdGenerator=t,this.defaultDispatcherOptions=e,this.store=r,this.reducedActions$=s.pipe(Object(h.a)(1)),this.raSubscription=this.reducedActions$.subscribe()}dispatch(t){return this.store.dispatch(t),t}cancelSaveEntities(t,e,s,r){if(!t)throw new Error("Missing correlationId");const a=new q(t,e,s,r);this.dispatch(a)}clearCollections(t,e){this.dispatch(new N(t,e))}loadCollections(t,e){this.dispatch(new R(t,e))}mergeQuerySet(t,e,s){this.dispatch(new F(t,e,s))}setEntityCache(t,e){this.dispatch(new L(t,e))}saveEntities(t,e,s){const r=Array.isArray(t)?{changes:t}:t,a=null==(s=s||{}).correlationId?this.correlationIdGenerator.next():s.correlationId,n=null==s.isOptimistic?this.defaultDispatcherOptions.optimisticSaveEntities||!1:!0===s.isOptimistic,i=s.tag||"Save Entities";s=Object.assign(Object.assign({},s),{correlationId:a,isOptimistic:n,tag:i});const c=new B(r,e,s);return this.dispatch(c),this.getSaveEntitiesResponseData$(s.correlationId).pipe(Object(h.a)(1))}getSaveEntitiesResponseData$(t){return this.reducedActions$.pipe(Object(a.a)(t=>"@ngrx/data/entity-cache/save-entities-success"===t.type||"@ngrx/data/entity-cache/save-entities-error"===t.type||"@ngrx/data/entity-cache/save-entities-cancel"===t.type),Object(a.a)(e=>t===e.payload.correlationId),Object(d.a)(1),Object(l.a)(t=>"@ngrx/data/entity-cache/save-entities-cancel"===t.type?Object(p.a)(new ot(t.payload.reason)):"@ngrx/data/entity-cache/save-entities-success"===t.type?Object(O.a)(t.payload.changeSet):Object(p.a)(t.payload)))}}return t.\u0275fac=function(e){return new(e||t)(r.gc(it),r.gc(ct),r.gc(v.g),r.gc(v.i))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})();class dt{constructor(t,e,s,r=D,a,n,i,c){this.entityName=t,this.entityActionFactory=e,this.store=s,this.selectId=r,this.defaultDispatcherOptions=a,this.reducedActions$=n,this.correlationIdGenerator=c,this.guard=new k(t,r),this.toUpdate=w(r);const o=Object(v.s)(i,e=>e[t]);this.entityCollection$=s.select(o)}createEntityAction(t,e,s){return this.entityActionFactory.create(Object.assign({entityName:this.entityName,entityOp:t,data:e},s))}createAndDispatch(t,e,s){const r=this.createEntityAction(t,e,s);return this.dispatch(r),r}dispatch(t){return this.store.dispatch(t),t}add(t,e){e=this.setSaveEntityActionOptions(e,this.defaultDispatcherOptions.optimisticAdd);const s=this.createEntityAction("@ngrx/data/save/add-one",t,e);return e.isOptimistic&&this.guard.mustBeEntity(s),this.dispatch(s),this.getResponseData$(e.correlationId).pipe(Object(u.a)(this.entityCollection$),Object(n.a)(([t,e])=>e.entities[this.selectId(t)]),Object(h.a)(1))}cancel(t,e,s){if(!t)throw new Error("Missing correlationId");this.createAndDispatch("@ngrx/data/cancel-persist",e,{correlationId:t})}delete(t,e){e=this.setSaveEntityActionOptions(e,this.defaultDispatcherOptions.optimisticDelete);const s=this.getKey(t),r=this.createEntityAction("@ngrx/data/save/delete-one",s,e);return this.guard.mustBeKey(r),this.dispatch(r),this.getResponseData$(e.correlationId).pipe(Object(n.a)(()=>s),Object(h.a)(1))}getAll(t){t=this.setQueryEntityActionOptions(t);const e=this.createEntityAction("@ngrx/data/query-all",null,t);return this.dispatch(e),this.getResponseData$(t.correlationId).pipe(Object(u.a)(this.entityCollection$),Object(n.a)(([t,e])=>t.reduce((t,s)=>{const r=e.entities[this.selectId(s)];return r&&t.push(r),t},[])),Object(h.a)(1))}getByKey(t,e){e=this.setQueryEntityActionOptions(e);const s=this.createEntityAction("@ngrx/data/query-by-key",t,e);return this.dispatch(s),this.getResponseData$(e.correlationId).pipe(Object(u.a)(this.entityCollection$),Object(n.a)(([t,e])=>e.entities[this.selectId(t)]),Object(h.a)(1))}getWithQuery(t,e){e=this.setQueryEntityActionOptions(e);const s=this.createEntityAction("@ngrx/data/query-many",t,e);return this.dispatch(s),this.getResponseData$(e.correlationId).pipe(Object(u.a)(this.entityCollection$),Object(n.a)(([t,e])=>t.reduce((t,s)=>{const r=e.entities[this.selectId(s)];return r&&t.push(r),t},[])),Object(h.a)(1))}load(t){t=this.setQueryEntityActionOptions(t);const e=this.createEntityAction("@ngrx/data/query-load",null,t);return this.dispatch(e),this.getResponseData$(t.correlationId).pipe(Object(h.a)(1))}update(t,e){const s=this.toUpdate(t);e=this.setSaveEntityActionOptions(e,this.defaultDispatcherOptions.optimisticUpdate);const r=this.createEntityAction("@ngrx/data/save/update-one",s,e);return e.isOptimistic&&this.guard.mustBeUpdate(r),this.dispatch(r),this.getResponseData$(e.correlationId).pipe(Object(n.a)(t=>t.changes),Object(u.a)(this.entityCollection$),Object(n.a)(([t,e])=>e.entities[this.selectId(t)]),Object(h.a)(1))}upsert(t,e){e=this.setSaveEntityActionOptions(e,this.defaultDispatcherOptions.optimisticUpsert);const s=this.createEntityAction("@ngrx/data/save/upsert-one",t,e);return e.isOptimistic&&this.guard.mustBeEntity(s),this.dispatch(s),this.getResponseData$(e.correlationId).pipe(Object(u.a)(this.entityCollection$),Object(n.a)(([t,e])=>e.entities[this.selectId(t)]),Object(h.a)(1))}addAllToCache(t,e){this.createAndDispatch("@ngrx/data/add-all",t,e)}addOneToCache(t,e){this.createAndDispatch("@ngrx/data/add-one",t,e)}addManyToCache(t,e){this.createAndDispatch("@ngrx/data/add-many",t,e)}clearCache(t){this.createAndDispatch("@ngrx/data/remove-all",void 0,t)}removeOneFromCache(t,e){this.createAndDispatch("@ngrx/data/remove-one",this.getKey(t),e)}removeManyFromCache(t,e){if(!t||0===t.length)return;const s="object"==typeof t[0]?t.map(t=>this.getKey(t)):t;this.createAndDispatch("@ngrx/data/remove-many",s,e)}updateOneInCache(t,e){const s=this.toUpdate(t);this.createAndDispatch("@ngrx/data/update-one",s,e)}updateManyInCache(t,e){if(!t||0===t.length)return;const s=t.map(t=>this.toUpdate(t));this.createAndDispatch("@ngrx/data/update-many",s,e)}upsertOneInCache(t,e){this.createAndDispatch("@ngrx/data/upsert-one",t,e)}upsertManyInCache(t,e){t&&0!==t.length&&this.createAndDispatch("@ngrx/data/upsert-many",t,e)}setFilter(t){this.createAndDispatch("@ngrx/data/set-filter",t)}setLoaded(t){this.createAndDispatch("@ngrx/data/set-loaded",!!t)}setLoading(t){this.createAndDispatch("@ngrx/data/set-loading",!!t)}getKey(t){return"object"==typeof t?this.selectId(t):t}getResponseData$(t){return this.reducedActions$.pipe(Object(a.a)(t=>!!t.payload),Object(a.a)(e=>{const{correlationId:s,entityName:r,entityOp:a}=e.payload;return r===this.entityName&&s===t&&(a.endsWith("/success")||a.endsWith("/error")||"@ngrx/data/cancel-persist"===a)}),Object(d.a)(1),Object(l.a)(t=>{const{entityOp:e}=t.payload;return"@ngrx/data/cancel-persist"===e?Object(p.a)(new ot(t.payload.data)):e.endsWith("/success")?Object(O.a)(t.payload.data):Object(p.a)(t.payload.data.error)}))}setQueryEntityActionOptions(t){const e=null==(t=t||{}).correlationId?this.correlationIdGenerator.next():t.correlationId;return Object.assign(Object.assign({},t),{correlationId:e})}setSaveEntityActionOptions(t,e){const s=null==(t=t||{}).correlationId?this.correlationIdGenerator.next():t.correlationId,r=null==t.isOptimistic?e||!1:!0===t.isOptimistic;return Object.assign(Object.assign({},t),{correlationId:s,isOptimistic:r})}}const lt=new r.r("@ngrx/data/entity-cache-name"),ut=new r.r("@ngrx/data/entity-cache-meta-reducers"),yt=new r.r("@ngrx/data/entity-collection-meta-reducers"),gt=new r.r("@ngrx/data/initial-entity-cache-state"),pt=new r.r("@ngrx/data/entity-cache-selector"),Ot={provide:pt,useFactory:mt,deps:[[new r.B,lt]]};function mt(t){return t=t||"entityCache",Object(v.q)(t)}let ft=(()=>{class t{constructor(t,e,s,r,a,n){this.entityActionFactory=t,this.store=e,this.entityDispatcherDefaultOptions=s,this.entityCacheSelector=a,this.correlationIdGenerator=n,this.reducedActions$=r.pipe(Object(h.a)(1)),this.raSubscription=this.reducedActions$.subscribe()}create(t,e=D,s={}){const r=Object.assign(Object.assign({},this.entityDispatcherDefaultOptions),s);return new dt(t,this.entityActionFactory,this.store,e,r,this.reducedActions$,this.entityCacheSelector,this.correlationIdGenerator)}ngOnDestroy(){this.raSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(r.gc(A),r.gc(v.i),r.gc(ct),r.gc(v.g),r.gc(pt),r.gc(it))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})();const bt=new r.r("EntityEffects Scheduler");let vt=(()=>{class t{constructor(t,e,s,r,n){this.actions=t,this.dataService=e,this.entityActionFactory=s,this.logger=r,this.scheduler=n,this.responseDelay=10,this.saveEntitiesCancel$=Object(x.d)(()=>this.actions.pipe(Object(x.e)("@ngrx/data/entity-cache/save-entities-cancel"),Object(a.a)(t=>null!=t.payload.correlationId)),{dispatch:!1}),this.saveEntities$=Object(x.d)(()=>this.actions.pipe(Object(x.e)("@ngrx/data/entity-cache/save-entities"),Object(l.a)(t=>this.saveEntities(t))))}saveEntities(t){const e=t.payload.error;if(e)return this.handleSaveEntitiesError$(t)(e);try{const e=$(t.payload.changeSet),{correlationId:s,mergeStrategy:r,tag:i,url:c}=t.payload,h={correlationId:s,mergeStrategy:r,tag:i};if(0===e.changes.length)return Object(O.a)(new Q(e,c,h));const d=this.saveEntitiesCancel$.pipe(Object(a.a)(t=>s===t.payload.correlationId),Object(n.a)(t=>new K(s,t.payload.reason,t.payload.tag))),l=this.dataService.saveEntities(e,c).pipe(Object(y.a)(e=>this.handleSaveEntitiesSuccess$(t,this.entityActionFactory)(e)),Object(o.a)(this.handleSaveEntitiesError$(t)));return Object(m.a)(d,l)}catch(s){return this.handleSaveEntitiesError$(t)(s)}}handleSaveEntitiesError$(t){return e=>{const s=e instanceof V?e:new V(e,null);return Object(O.a)(new P(s,t)).pipe(Object(i.a)(this.responseDelay,this.scheduler||f.a))}}handleSaveEntitiesSuccess$(t,e){const{url:s,correlationId:r,mergeStrategy:a,tag:n}=t.payload,i={correlationId:r,mergeStrategy:a,tag:n};return r=>{if(r)return Object(O.a)(new Q(r,s,i));if(r=t.payload.changeSet,!t.payload.isOptimistic)return Object(O.a)(new Q(r,s,i));const a=r.changes.reduce((t,e)=>-1===t.indexOf(e.entityName)?t.concat(e.entityName):t,[]);return Object(b.a)(a.map(t=>e.create(t,"@ngrx/data/set-loading",!1)))}}}return t.\u0275fac=function(e){return new(e||t)(r.gc(x.a),r.gc(st),r.gc(A),r.gc(W),r.gc(bt,8))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})();const St=["@ngrx/data/query-all","@ngrx/data/query-load","@ngrx/data/query-by-key","@ngrx/data/query-many","@ngrx/data/save/add-one","@ngrx/data/save/delete-one","@ngrx/data/save/update-one","@ngrx/data/save/upsert-one"];let jt=(()=>{class t{constructor(t,e,s,r,i){this.actions=t,this.dataService=e,this.entityActionFactory=s,this.resultHandler=r,this.scheduler=i,this.responseDelay=10,this.cancel$=Object(x.d)(()=>this.actions.pipe(U("@ngrx/data/cancel-persist"),Object(n.a)(t=>t.payload.correlationId),Object(a.a)(t=>null!=t)),{dispatch:!1}),this.persist$=Object(x.d)(()=>this.actions.pipe(U(St),Object(l.a)(t=>this.persist(t))))}persist(t){if(t.payload.skip)return this.handleSkipSuccess$(t);if(t.payload.error)return this.handleError$(t)(t.payload.error);try{const e=this.cancel$.pipe(Object(a.a)(e=>t.payload.correlationId===e),Object(n.a)(e=>this.entityActionFactory.createFromAction(t,{entityOp:"@ngrx/data/canceled-persist"}))),s=this.callDataService(t).pipe(Object(n.a)(this.resultHandler.handleSuccess(t)),Object(o.a)(this.handleError$(t)));return Object(m.a)(e,s)}catch(e){return this.handleError$(t)(e)}}callDataService(t){const{entityName:e,entityOp:s,data:r}=t.payload,a=this.dataService.getService(e);switch(s){case"@ngrx/data/query-all":case"@ngrx/data/query-load":return a.getAll();case"@ngrx/data/query-by-key":return a.getById(r);case"@ngrx/data/query-many":return a.getWithQuery(r);case"@ngrx/data/save/add-one":return a.add(r);case"@ngrx/data/save/delete-one":return a.delete(r);case"@ngrx/data/save/update-one":const{id:t,changes:e}=r;return a.update(r).pipe(Object(n.a)(s=>s&&Object.keys(s).length>0?{id:t,changes:Object.assign(Object.assign({},e),s),changed:!0}:{id:t,changes:e,changed:!1}));case"@ngrx/data/save/upsert-one":return a.upsert(r).pipe(Object(n.a)(t=>t&&Object.keys(t).length>0?t:r));default:throw new Error(`Persistence action "${s}" is not implemented.`)}}handleError$(t){return e=>Object(O.a)(this.resultHandler.handleError(t)(e)).pipe(Object(i.a)(this.responseDelay,this.scheduler||f.a))}handleSkipSuccess$(t){const e=G(t.payload.entityOp),s=this.entityActionFactory.createFromAction(t,{entityOp:e});return Object(O.a)(s).pipe(Object(i.a)(this.responseDelay,this.scheduler||f.a))}}return t.\u0275fac=function(e){return new(e||t)(r.gc(x.a),r.gc(rt),r.gc(A),r.gc(at),r.gc(bt,8))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})();class Ct{constructor(t,e){this.entityName=t,t=t.trim();const{dispatcher:s,selectors:r,selectors$:a}=e.create(t);this.entityName=t,this.dispatcher=s,this.guard=s.guard,this.selectId=s.selectId,this.toUpdate=s.toUpdate,this.selectors=r,this.selectors$=a,this.collection$=a.collection$,this.count$=a.count$,this.entities$=a.entities$,this.entityActions$=a.entityActions$,this.entityMap$=a.entityMap$,this.errors$=a.errors$,this.filter$=a.filter$,this.filteredEntities$=a.filteredEntities$,this.keys$=a.keys$,this.loaded$=a.loaded$,this.loading$=a.loading$,this.changeState$=a.changeState$}createEntityAction(t,e,s){return this.dispatcher.createEntityAction(t,e,s)}createAndDispatch(t,e,s){return this.dispatcher.createAndDispatch(t,e,s)}dispatch(t){return this.dispatcher.dispatch(t)}get store(){return this.dispatcher.store}add(t,e){return this.dispatcher.add(t,e)}cancel(t,e,s){this.dispatcher.cancel(t,e,s)}delete(t,e){return this.dispatcher.delete(t,e)}getAll(t){return this.dispatcher.getAll(t)}getByKey(t,e){return this.dispatcher.getByKey(t,e)}getWithQuery(t,e){return this.dispatcher.getWithQuery(t,e)}load(t){return this.dispatcher.load(t)}update(t,e){return this.dispatcher.update(t,e)}upsert(t,e){return this.dispatcher.upsert(t,e)}addAllToCache(t,e){this.dispatcher.addAllToCache(t,e)}addOneToCache(t,e){this.dispatcher.addOneToCache(t,e)}addManyToCache(t,e){this.dispatcher.addManyToCache(t,e)}clearCache(){this.dispatcher.clearCache()}removeOneFromCache(t,e){this.dispatcher.removeOneFromCache(t,e)}removeManyFromCache(t,e){this.dispatcher.removeManyFromCache(t,e)}updateOneInCache(t,e){this.dispatcher.updateOneInCache(t,e)}updateManyInCache(t,e){this.dispatcher.updateManyInCache(t,e)}upsertOneInCache(t,e){this.dispatcher.upsertOneInCache(t,e)}upsertManyInCache(t,e){this.dispatcher.upsertManyInCache(t,e)}setFilter(t){this.dispatcher.setFilter(t)}setLoaded(t){this.dispatcher.setLoaded(!!t)}setLoading(t){this.dispatcher.setLoading(!!t)}}let Et=(()=>{class t{constructor(t){this.entityDefinitionService=t}create(t){const e=this.entityDefinitionService&&this.entityDefinitionService.getDefinition(t,!1);return e&&e.initialState||function(t){return{entityName:t,ids:[],entities:{},filter:void 0,loaded:!1,loading:!1,changeState:{}}}(t)}}return t.\u0275fac=function(e){return new(e||t)(r.gc(et,8))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})(),xt=(()=>{class t{constructor(t,e){this.entityCollectionCreator=t||new Et,this.selectEntityCache=e||mt("entityCache")}createCollectionSelector(t){return Object(v.s)(this.selectEntityCache,(e={})=>e[t]||this.entityCollectionCreator.create(t))}createCollectionSelectors(t){const e="string"==typeof t?{entityName:t}:t,s=t=>t.ids,r=t=>t.entities,a=Object(v.s)(s,r,(t,e)=>t.map(t=>e[t])),n=Object(v.s)(s,t=>t.length),i=t=>t.filter,c=e.filterFn,o=c?Object(v.s)(a,i,(t,e)=>c(t,e)):a,h={};return Object.keys(e.additionalCollectionState||{}).forEach(t=>{h["select"+t[0].toUpperCase()+t.slice(1)]=e=>e[t]}),Object.assign({selectCount:n,selectEntities:a,selectEntityMap:r,selectFilter:i,selectFilteredEntities:o,selectKeys:s,selectLoaded:t=>t.loaded,selectLoading:t=>t.loading,selectChangeState:t=>t.changeState},h)}create(t){const e="string"==typeof t?{entityName:t}:t,s=e.entityName,r=this.createCollectionSelector(s),a=this.createCollectionSelectors(e),n={};return Object.keys(a).forEach(t=>{n[t]=Object(v.s)(r,a[t])}),Object.assign({entityName:s,selectCollection:r,selectEntityCache:this.selectEntityCache},n)}}return t.\u0275fac=function(e){return new(e||t)(r.gc(Et,8),r.gc(pt,8))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})(),At=(()=>{class t{constructor(t,e,s){this.store=t,this.actions=e,this.selectEntityCache=s,this.entityCache$=this.store.select(this.selectEntityCache),this.entityActionErrors$=e.pipe(Object(a.a)(t=>t.payload&&t.payload.entityOp&&t.payload.entityOp.endsWith("/error")),Object(h.a)(1))}create(t,e){const s={entityName:t};return Object.keys(e).forEach(t=>{if(t.startsWith("select")){const r=t[6].toLowerCase()+t.substr(7)+"$";s[r]=this.store.select(e[t])}}),s.entityActions$=this.actions.pipe(I(t)),s.errors$=this.entityActionErrors$.pipe(I(t)),s}}return t.\u0275fac=function(e){return new(e||t)(r.gc(v.i),r.gc(x.a),r.gc(pt))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})(),kt=(()=>{class t{constructor(t,e,s,r){this.entityDispatcherFactory=t,this.entityDefinitionService=e,this.entitySelectorsFactory=s,this.entitySelectors$Factory=r}create(t){t=t.trim();const e=this.entityDefinitionService.getDefinition(t),s=this.entityDispatcherFactory.create(t,e.selectId,e.entityDispatcherOptions),r=this.entitySelectorsFactory.create(e.metadata);return{dispatcher:s,entityName:t,selectors:r,selectors$:this.entitySelectors$Factory.create(t,r)}}}return t.\u0275fac=function(e){return new(e||t)(r.gc(ft),r.gc(et),r.gc(xt),r.gc(At))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})(),Dt=(()=>{class t{constructor(t){this.entityCollectionServiceElementsFactory=t}create(t){return new Ct(t,this.entityCollectionServiceElementsFactory)}}return t.\u0275fac=function(e){return new(e||t)(r.gc(kt))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})(),Mt=(()=>{class t{constructor(t,e,s,r){this.entityCollectionServiceFactory=t,this.store=r,this.entityActionErrors$=s.entityActionErrors$,this.entityCache$=s.entityCache$,this.reducedActions$=e.reducedActions$}}return t.\u0275fac=function(e){return new(e||t)(r.gc(Dt),r.gc(ft),r.gc(At),r.gc(v.i))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})(),wt=(()=>{class t{constructor(t){this.entityServicesElements=t,this.EntityCollectionServices={}}get entityActionErrors$(){return this.entityServicesElements.entityActionErrors$}get entityCache$(){return this.entityServicesElements.entityCache$}get entityCollectionServiceFactory(){return this.entityServicesElements.entityCollectionServiceFactory}get reducedActions$(){return this.entityServicesElements.reducedActions$}get store(){return this.entityServicesElements.store}dispatch(t){this.store.dispatch(t)}createEntityCollectionService(t){return this.entityCollectionServiceFactory.create(t)}getEntityCollectionService(t){let e=this.EntityCollectionServices[t];return e||(e=this.createEntityCollectionService(t),this.EntityCollectionServices[t]=e),e}registerEntityCollectionService(t,e){this.EntityCollectionServices[e||t.entityName]=t}registerEntityCollectionServices(t){Array.isArray(t)?t.forEach(t=>this.registerEntityCollectionService(t)):Object.keys(t||{}).forEach(e=>{this.registerEntityCollectionService(t[e],e)})}}return t.\u0275fac=function(e){return new(e||t)(r.gc(Mt))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})();class Ut{}const It=function(){var t={Unchanged:0,Added:1,Deleted:2,Updated:3};return t[t.Unchanged]="Unchanged",t[t.Added]="Added",t[t.Deleted]="Deleted",t[t.Updated]="Updated",t}();class $t{constructor(t,e){this.adapter=t,this.selectId=e,this.selectId=e||D}commitAll(t){return 0===Object.keys(t.changeState).length?t:Object.assign(Object.assign({},t),{changeState:{}})}commitMany(t,e){if(null==t||0===t.length)return e;let s=!1;const r=t.reduce((t,e)=>{const r="object"==typeof e?this.selectId(e):e;return t[r]&&(s||(t=Object.assign({},t),s=!0),delete t[r]),t},e.changeState);return s?Object.assign(Object.assign({},e),{changeState:r}):e}commitOne(t,e){return null==t?e:this.commitMany([t],e)}mergeQueryResults(t,e,s){return this.mergeServerUpserts(t,e,T.PreserveChanges,s)}mergeSaveAdds(t,e,s){return this.mergeServerUpserts(t,e,T.OverwriteChanges,s)}mergeSaveDeletes(t,e,s){const r=t;return e=(s=null==s?T.OverwriteChanges:s)===T.IgnoreChanges?e:this.commitMany(r,e),this.adapter.removeMany(r,e)}mergeSaveUpdates(t,e,s,r=!1){if(null==t||0===t.length)return e;let a,n=!1,i=e.changeState;switch(s=null==s?T.OverwriteChanges:s){case T.IgnoreChanges:return a=c(t),this.adapter.updateMany(a,e);case T.OverwriteChanges:return i=t.reduce((t,e)=>{const s=e.id;return t[s]&&(n||(t=Object.assign({},t),n=!0),delete t[s]),t},e.changeState),e=n?Object.assign(Object.assign({},e),{changeState:i}):e,a=c(t),this.adapter.updateMany(a,e);case T.PreserveChanges:{const s=[];return i=t.reduce((t,e)=>{const r=e.id,a=t[r];if(a){n||(t=Object.assign({},t),n=!0);const s=this.selectId(e.changes),i=a;s!==r&&delete t[r];const c=Object.assign(Object.assign({},i.originalValue),e.changes);t[s]=Object.assign(Object.assign({},i),{originalValue:c})}else s.push(e);return t},e.changeState),e=n?Object.assign(Object.assign({},e),{changeState:i}):e,a=c(s),this.adapter.updateMany(a,e)}}function c(t){return!0===r&&(t=t.filter(t=>!0===t.changed)),t.map(t=>({id:t.id,changes:t.changes}))}}mergeSaveUpserts(t,e,s){return this.mergeServerUpserts(t,e,T.OverwriteChanges,s)}mergeServerUpserts(t,e,s,r){if(null==t||0===t.length)return e;let a=!1,n=e.changeState;switch(r=null==r?s:r){case T.IgnoreChanges:return this.adapter.upsertMany(t,e);case T.OverwriteChanges:return e=this.adapter.upsertMany(t,e),n=t.reduce((t,e)=>{const s=this.selectId(e);return t[s]&&(a||(t=Object.assign({},t),a=!0),delete t[s]),t},e.changeState),a?Object.assign(Object.assign({},e),{changeState:n}):e;case T.PreserveChanges:{const s=[];return n=t.reduce((t,e)=>{const r=this.selectId(e);return t[r]?a||(t=Object.assign(Object.assign({},t),{[r]:Object.assign(Object.assign({},t[r]),{originalValue:e})}),a=!0):s.push(e),t},e.changeState),e=this.adapter.upsertMany(s,e),a?Object.assign(Object.assign({},e),{changeState:n}):e}}}trackAddMany(t,e,s){if(s===T.IgnoreChanges||null==t||0===t.length)return e;let r=!1;const a=t.reduce((t,s)=>{const a=this.selectId(s);if(null==a||""===a)throw new Error(e.entityName+" entity add requires a key to be tracked");return t[a]||(r||(r=!0,t=Object.assign({},t)),t[a]={changeType:It.Added}),t},e.changeState);return r?Object.assign(Object.assign({},e),{changeState:a}):e}trackAddOne(t,e,s){return null==t?e:this.trackAddMany([t],e,s)}trackDeleteMany(t,e,s){if(s===T.IgnoreChanges||null==t||0===t.length)return e;let r=!1;const a=e.entities,n=t.reduce((t,e)=>{const s=a[e];if(s){const r=t[e];r?r.changeType===It.Added?(n(),delete t[e]):r.changeType===It.Updated&&(n(),r.changeType=It.Deleted):(n(),t[e]={changeType:It.Deleted,originalValue:s})}return t;function n(){r||(r=!0,t=Object.assign({},t))}},e.changeState);return r?Object.assign(Object.assign({},e),{changeState:n}):e}trackDeleteOne(t,e,s){return null==t?e:this.trackDeleteMany([t],e,s)}trackUpdateMany(t,e,s){if(s===T.IgnoreChanges||null==t||0===t.length)return e;let r=!1;const a=e.entities,n=t.reduce((t,s)=>{const{id:n}=s;if(null==n||""===n)throw new Error(e.entityName+" entity update requires a key to be tracked");const i=a[n];return i&&(t[n]||(r||(r=!0,t=Object.assign({},t)),t[n]={changeType:It.Updated,originalValue:i})),t},e.changeState);return r?Object.assign(Object.assign({},e),{changeState:n}):e}trackUpdateOne(t,e,s){return null==t?e:this.trackUpdateMany([t],e,s)}trackUpsertMany(t,e,s){if(s===T.IgnoreChanges||null==t||0===t.length)return e;let r=!1;const a=e.entities,n=t.reduce((t,s)=>{const n=this.selectId(s);if(null==n||""===n)throw new Error(e.entityName+" entity upsert requires a key to be tracked");if(!t[n]){r||(r=!0,t=Object.assign({},t));const e=a[n];t[n]=null==e?{changeType:It.Added}:{changeType:It.Updated,originalValue:e}}return t},e.changeState);return r?Object.assign(Object.assign({},e),{changeState:n}):e}trackUpsertOne(t,e,s){return null==t?e:this.trackUpsertMany([t],e,s)}undoAll(t){const e=Object.keys(t.changeState),{remove:s,upsert:r}=e.reduce((t,e)=>{const s=t.chgState[e];switch(s.changeType){case It.Added:t.remove.push(e);break;case It.Deleted:const r=s.originalValue;r&&t.upsert.push(r);break;case It.Updated:t.upsert.push(s.originalValue)}return t},{remove:[],upsert:[],chgState:t.changeState});return t=this.adapter.removeMany(s,t),t=this.adapter.upsertMany(r,t),Object.assign(Object.assign({},t),{changeState:{}})}undoMany(t,e){if(null==t||0===t.length)return e;let s=!1;const{changeState:r,remove:a,upsert:n}=t.reduce((t,e)=>{let r=t.changeState;const a="object"==typeof e?this.selectId(e):e,n=r[a];if(n)switch(s||(r=Object.assign({},r),s=!0),delete r[a],t.changeState=r,n.changeType){case It.Added:t.remove.push(a);break;case It.Deleted:const e=n.originalValue;e&&t.upsert.push(e);break;case It.Updated:t.upsert.push(n.originalValue)}return t},{remove:[],upsert:[],changeState:e.changeState});return e=this.adapter.removeMany(a,e),e=this.adapter.upsertMany(n,e),s?Object.assign(Object.assign({},e),{changeState:r}):e}undoOne(t,e){return null==t?e:this.undoMany([t],e)}}class Tt{constructor(t,e,s){this.entityName=t,this.definition=e,this.methods={"@ngrx/data/cancel-persist":this.cancelPersist.bind(this),"@ngrx/data/query-all":this.queryAll.bind(this),"@ngrx/data/query-all/error":this.queryAllError.bind(this),"@ngrx/data/query-all/success":this.queryAllSuccess.bind(this),"@ngrx/data/query-by-key":this.queryByKey.bind(this),"@ngrx/data/query-by-key/error":this.queryByKeyError.bind(this),"@ngrx/data/query-by-key/success":this.queryByKeySuccess.bind(this),"@ngrx/data/query-load":this.queryLoad.bind(this),"@ngrx/data/query-load/error":this.queryLoadError.bind(this),"@ngrx/data/query-load/success":this.queryLoadSuccess.bind(this),"@ngrx/data/query-many":this.queryMany.bind(this),"@ngrx/data/query-many/error":this.queryManyError.bind(this),"@ngrx/data/query-many/success":this.queryManySuccess.bind(this),"@ngrx/data/save/add-many":this.saveAddMany.bind(this),"@ngrx/data/save/add-many/error":this.saveAddManyError.bind(this),"@ngrx/data/save/add-many/success":this.saveAddManySuccess.bind(this),"@ngrx/data/save/add-one":this.saveAddOne.bind(this),"@ngrx/data/save/add-one/error":this.saveAddOneError.bind(this),"@ngrx/data/save/add-one/success":this.saveAddOneSuccess.bind(this),"@ngrx/data/save/delete-many":this.saveDeleteMany.bind(this),"@ngrx/data/save/delete-many/error":this.saveDeleteManyError.bind(this),"@ngrx/data/save/delete-many/success":this.saveDeleteManySuccess.bind(this),"@ngrx/data/save/delete-one":this.saveDeleteOne.bind(this),"@ngrx/data/save/delete-one/error":this.saveDeleteOneError.bind(this),"@ngrx/data/save/delete-one/success":this.saveDeleteOneSuccess.bind(this),"@ngrx/data/save/update-many":this.saveUpdateMany.bind(this),"@ngrx/data/save/update-many/error":this.saveUpdateManyError.bind(this),"@ngrx/data/save/update-many/success":this.saveUpdateManySuccess.bind(this),"@ngrx/data/save/update-one":this.saveUpdateOne.bind(this),"@ngrx/data/save/update-one/error":this.saveUpdateOneError.bind(this),"@ngrx/data/save/update-one/success":this.saveUpdateOneSuccess.bind(this),"@ngrx/data/save/upsert-many":this.saveUpsertMany.bind(this),"@ngrx/data/save/upsert-many/error":this.saveUpsertManyError.bind(this),"@ngrx/data/save/upsert-many/success":this.saveUpsertManySuccess.bind(this),"@ngrx/data/save/upsert-one":this.saveUpsertOne.bind(this),"@ngrx/data/save/upsert-one/error":this.saveUpsertOneError.bind(this),"@ngrx/data/save/upsert-one/success":this.saveUpsertOneSuccess.bind(this),"@ngrx/data/add-all":this.addAll.bind(this),"@ngrx/data/add-many":this.addMany.bind(this),"@ngrx/data/add-one":this.addOne.bind(this),"@ngrx/data/remove-all":this.removeAll.bind(this),"@ngrx/data/remove-many":this.removeMany.bind(this),"@ngrx/data/remove-one":this.removeOne.bind(this),"@ngrx/data/update-many":this.updateMany.bind(this),"@ngrx/data/update-one":this.updateOne.bind(this),"@ngrx/data/upsert-many":this.upsertMany.bind(this),"@ngrx/data/upsert-one":this.upsertOne.bind(this),"@ngrx/data/commit-all":this.commitAll.bind(this),"@ngrx/data/commit-many":this.commitMany.bind(this),"@ngrx/data/commit-one":this.commitOne.bind(this),"@ngrx/data/undo-all":this.undoAll.bind(this),"@ngrx/data/undo-many":this.undoMany.bind(this),"@ngrx/data/undo-one":this.undoOne.bind(this),"@ngrx/data/set-change-state":this.setChangeState.bind(this),"@ngrx/data/set-collection":this.setCollection.bind(this),"@ngrx/data/set-filter":this.setFilter.bind(this),"@ngrx/data/set-loaded":this.setLoaded.bind(this),"@ngrx/data/set-loading":this.setLoading.bind(this)},this.adapter=e.entityAdapter,this.isChangeTracking=!0!==e.noChangeTracking,this.selectId=e.selectId,this.guard=new k(t,this.selectId),this.toUpdate=w(this.selectId),this.entityChangeTracker=s||new $t(this.adapter,this.selectId)}cancelPersist(t){return this.setLoadingFalse(t)}queryAll(t){return this.setLoadingTrue(t)}queryAllError(t,e){return this.setLoadingFalse(t)}queryAllSuccess(t,e){const s=this.extractData(e),r=this.extractMergeStrategy(e);return Object.assign(Object.assign({},this.entityChangeTracker.mergeQueryResults(s,t,r)),{loaded:!0,loading:!1})}queryByKey(t,e){return this.setLoadingTrue(t)}queryByKeyError(t,e){return this.setLoadingFalse(t)}queryByKeySuccess(t,e){const s=this.extractData(e),r=this.extractMergeStrategy(e);return t=null==s?t:this.entityChangeTracker.mergeQueryResults([s],t,r),this.setLoadingFalse(t)}queryLoad(t){return this.setLoadingTrue(t)}queryLoadError(t,e){return this.setLoadingFalse(t)}queryLoadSuccess(t,e){const s=this.extractData(e);return Object.assign(Object.assign({},this.adapter.addAll(s,t)),{loading:!1,loaded:!0,changeState:{}})}queryMany(t,e){return this.setLoadingTrue(t)}queryManyError(t,e){return this.setLoadingFalse(t)}queryManySuccess(t,e){const s=this.extractData(e),r=this.extractMergeStrategy(e);return Object.assign(Object.assign({},this.entityChangeTracker.mergeQueryResults(s,t,r)),{loading:!1})}saveAddMany(t,e){if(this.isOptimistic(e)){const s=this.guard.mustBeEntities(e),r=this.extractMergeStrategy(e);t=this.entityChangeTracker.trackAddMany(s,t,r),t=this.adapter.addMany(s,t)}return this.setLoadingTrue(t)}saveAddManyError(t,e){return this.setLoadingFalse(t)}saveAddManySuccess(t,e){const s=this.guard.mustBeEntities(e),r=this.extractMergeStrategy(e);return t=this.isOptimistic(e)?this.entityChangeTracker.mergeSaveUpserts(s,t,r):this.entityChangeTracker.mergeSaveAdds(s,t,r),this.setLoadingFalse(t)}saveAddOne(t,e){if(this.isOptimistic(e)){const s=this.guard.mustBeEntity(e),r=this.extractMergeStrategy(e);t=this.entityChangeTracker.trackAddOne(s,t,r),t=this.adapter.addOne(s,t)}return this.setLoadingTrue(t)}saveAddOneError(t,e){return this.setLoadingFalse(t)}saveAddOneSuccess(t,e){const s=this.guard.mustBeEntity(e),r=this.extractMergeStrategy(e);if(this.isOptimistic(e)){const e=this.toUpdate(s);t=this.entityChangeTracker.mergeSaveUpdates([e],t,r,!1)}else t=this.entityChangeTracker.mergeSaveAdds([s],t,r);return this.setLoadingFalse(t)}saveDeleteOne(t,e){const s=this.extractData(e),r="object"==typeof s?this.selectId(s):s,a=t.changeState[r];if(a&&(a.changeType===It.Added?(t=this.adapter.removeOne(r,t),t=this.entityChangeTracker.commitOne(r,t),e.payload.skip=!0):t=this.entityChangeTracker.trackDeleteOne(r,t)),this.isOptimistic(e)){const s=this.extractMergeStrategy(e);t=this.entityChangeTracker.trackDeleteOne(r,t,s),t=this.adapter.removeOne(r,t)}return this.setLoadingTrue(t)}saveDeleteOneError(t,e){return this.setLoadingFalse(t)}saveDeleteOneSuccess(t,e){const s=this.extractData(e);if(this.isOptimistic(e)){const r=this.extractMergeStrategy(e);t=this.entityChangeTracker.mergeSaveDeletes([s],t,r)}else t=this.adapter.removeOne(s,t),t=this.entityChangeTracker.commitOne(s,t);return this.setLoadingFalse(t)}saveDeleteMany(t,e){const s=this.extractData(e).map(t=>"object"==typeof t?this.selectId(t):t);if(s.forEach(s=>{const r=t.changeState[s];r&&(r.changeType===It.Added?(t=this.adapter.removeOne(s,t),t=this.entityChangeTracker.commitOne(s,t),e.payload.skip=!0):t=this.entityChangeTracker.trackDeleteOne(s,t))}),this.isOptimistic(e)){const r=this.extractMergeStrategy(e);t=this.entityChangeTracker.trackDeleteMany(s,t,r),t=this.adapter.removeMany(s,t)}return this.setLoadingTrue(t)}saveDeleteManyError(t,e){return this.setLoadingFalse(t)}saveDeleteManySuccess(t,e){const s=this.extractData(e);if(this.isOptimistic(e)){const r=this.extractMergeStrategy(e);t=this.entityChangeTracker.mergeSaveDeletes(s,t,r)}else t=this.adapter.removeMany(s,t),t=this.entityChangeTracker.commitMany(s,t);return this.setLoadingFalse(t)}saveUpdateOne(t,e){const s=this.guard.mustBeUpdate(e);if(this.isOptimistic(e)){const r=this.extractMergeStrategy(e);t=this.entityChangeTracker.trackUpdateOne(s,t,r),t=this.adapter.updateOne(s,t)}return this.setLoadingTrue(t)}saveUpdateOneError(t,e){return this.setLoadingFalse(t)}saveUpdateOneSuccess(t,e){const s=this.guard.mustBeUpdateResponse(e),r=this.isOptimistic(e),a=this.extractMergeStrategy(e);return t=this.entityChangeTracker.mergeSaveUpdates([s],t,a,r),this.setLoadingFalse(t)}saveUpdateMany(t,e){const s=this.guard.mustBeUpdates(e);if(this.isOptimistic(e)){const r=this.extractMergeStrategy(e);t=this.entityChangeTracker.trackUpdateMany(s,t,r),t=this.adapter.updateMany(s,t)}return this.setLoadingTrue(t)}saveUpdateManyError(t,e){return this.setLoadingFalse(t)}saveUpdateManySuccess(t,e){const s=this.guard.mustBeUpdateResponses(e),r=(this.isOptimistic(e),this.extractMergeStrategy(e));return t=this.entityChangeTracker.mergeSaveUpdates(s,t,r,!1),this.setLoadingFalse(t)}saveUpsertOne(t,e){if(this.isOptimistic(e)){const s=this.guard.mustBeEntity(e),r=this.extractMergeStrategy(e);t=this.entityChangeTracker.trackUpsertOne(s,t,r),t=this.adapter.upsertOne(s,t)}return this.setLoadingTrue(t)}saveUpsertOneError(t,e){return this.setLoadingFalse(t)}saveUpsertOneSuccess(t,e){const s=this.guard.mustBeEntity(e),r=this.extractMergeStrategy(e);return t=this.entityChangeTracker.mergeSaveUpserts([s],t,r),this.setLoadingFalse(t)}saveUpsertMany(t,e){if(this.isOptimistic(e)){const s=this.guard.mustBeEntities(e),r=this.extractMergeStrategy(e);t=this.entityChangeTracker.trackUpsertMany(s,t,r),t=this.adapter.upsertMany(s,t)}return this.setLoadingTrue(t)}saveUpsertManyError(t,e){return this.setLoadingFalse(t)}saveUpsertManySuccess(t,e){const s=this.guard.mustBeEntities(e),r=this.extractMergeStrategy(e);return t=this.entityChangeTracker.mergeSaveUpserts(s,t,r),this.setLoadingFalse(t)}addAll(t,e){const s=this.guard.mustBeEntities(e);return Object.assign(Object.assign({},this.adapter.addAll(s,t)),{loading:!1,loaded:!0,changeState:{}})}addMany(t,e){const s=this.guard.mustBeEntities(e),r=this.extractMergeStrategy(e);return t=this.entityChangeTracker.trackAddMany(s,t,r),this.adapter.addMany(s,t)}addOne(t,e){const s=this.guard.mustBeEntity(e),r=this.extractMergeStrategy(e);return t=this.entityChangeTracker.trackAddOne(s,t,r),this.adapter.addOne(s,t)}removeMany(t,e){const s=this.guard.mustBeKeys(e),r=this.extractMergeStrategy(e);return t=this.entityChangeTracker.trackDeleteMany(s,t,r),this.adapter.removeMany(s,t)}removeOne(t,e){const s=this.guard.mustBeKey(e),r=this.extractMergeStrategy(e);return t=this.entityChangeTracker.trackDeleteOne(s,t,r),this.adapter.removeOne(s,t)}removeAll(t,e){return Object.assign(Object.assign({},this.adapter.removeAll(t)),{loaded:!1,loading:!1,changeState:{}})}updateMany(t,e){const s=this.guard.mustBeUpdates(e),r=this.extractMergeStrategy(e);return t=this.entityChangeTracker.trackUpdateMany(s,t,r),this.adapter.updateMany(s,t)}updateOne(t,e){const s=this.guard.mustBeUpdate(e),r=this.extractMergeStrategy(e);return t=this.entityChangeTracker.trackUpdateOne(s,t,r),this.adapter.updateOne(s,t)}upsertMany(t,e){const s=this.guard.mustBeEntities(e),r=this.extractMergeStrategy(e);return t=this.entityChangeTracker.trackUpsertMany(s,t,r),this.adapter.upsertMany(s,t)}upsertOne(t,e){const s=this.guard.mustBeEntity(e),r=this.extractMergeStrategy(e);return t=this.entityChangeTracker.trackUpsertOne(s,t,r),this.adapter.upsertOne(s,t)}commitAll(t){return this.entityChangeTracker.commitAll(t)}commitMany(t,e){return this.entityChangeTracker.commitMany(this.extractData(e),t)}commitOne(t,e){return this.entityChangeTracker.commitOne(this.extractData(e),t)}undoAll(t){return this.entityChangeTracker.undoAll(t)}undoMany(t,e){return this.entityChangeTracker.undoMany(this.extractData(e),t)}undoOne(t,e){return this.entityChangeTracker.undoOne(this.extractData(e),t)}setChangeState(t,e){const s=this.extractData(e);return t.changeState===s?t:Object.assign(Object.assign({},t),{changeState:s})}setCollection(t,e){const s=this.extractData(e);return t===s?t:s}setFilter(t,e){const s=this.extractData(e);return t.filter===s?t:Object.assign(Object.assign({},t),{filter:s})}setLoaded(t,e){const s=!0===this.extractData(e)||!1;return t.loaded===s?t:Object.assign(Object.assign({},t),{loaded:s})}setLoading(t,e){return this.setLoadingFlag(t,this.extractData(e))}setLoadingFalse(t){return this.setLoadingFlag(t,!1)}setLoadingTrue(t){return this.setLoadingFlag(t,!0)}setLoadingFlag(t,e){return t.loading===(e=!0===e)?t:Object.assign(Object.assign({},t),{loading:e})}extractData(t){return t.payload&&t.payload.data}extractMergeStrategy(t){return this.isChangeTracking?t.payload&&t.payload.mergeStrategy:T.IgnoreChanges}isOptimistic(t){return t.payload&&!0===t.payload.isOptimistic}}let Nt=(()=>{class t{constructor(t){this.entityDefinitionService=t}create(t){const e=this.entityDefinitionService.getDefinition(t);return new Tt(t,e).methods}}return t.\u0275fac=function(e){return new(e||t)(r.gc(et))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})(),Rt=(()=>{class t{constructor(t){this.methodsFactory=t}create(t){const e=this.methodsFactory.create(t);return function(t,s){const r=e[s.payload.entityOp];return r?r(t,s):t}}}return t.\u0275fac=function(e){return new(e||t)(r.gc(Nt))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})(),Ft=(()=>{class t{constructor(t,e){this.entityCollectionReducerFactory=t,this.entityCollectionReducers={},this.entityCollectionMetaReducer=v.o.apply(null,e||[])}getOrCreateReducer(t){let e=this.entityCollectionReducers[t];return e||(e=this.entityCollectionReducerFactory.create(t),e=this.registerReducer(t,e),this.entityCollectionReducers[t]=e),e}registerReducer(t,e){return e=this.entityCollectionMetaReducer(e),this.entityCollectionReducers[t.trim()]=e}registerReducers(t){(t?Object.keys(t):[]).forEach(e=>this.registerReducer(e,t[e]))}}return t.\u0275fac=function(e){return new(e||t)(r.gc(Rt),r.gc(yt,8))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})(),Lt=(()=>{class t{constructor(t,e,s){this.entityCollectionCreator=t,this.entityCollectionReducerRegistry=e,this.logger=s}create(){return(function(t={},e){switch(e.type){case"@ngrx/data/entity-cache/clear-collections":return this.clearCollectionsReducer(t,e);case"@ngrx/data/entity-cache/load-collections":return this.loadCollectionsReducer(t,e);case"@ngrx/data/entity-cache/merge-query-set":return this.mergeQuerySetReducer(t,e);case"@ngrx/data/entity-cache/save-entities":return this.saveEntitiesReducer(t,e);case"@ngrx/data/entity-cache/save-entities-cancel":return this.saveEntitiesCancelReducer(t,e);case"@ngrx/data/entity-cache/save-entities-error":return this.saveEntitiesErrorReducer(t,e);case"@ngrx/data/entity-cache/save-entities-success":return this.saveEntitiesSuccessReducer(t,e);case"@ngrx/data/entity-cache/set-cache":return e.payload.cache}const s=e.payload;return s&&s.entityName&&s.entityOp&&!s.error?this.applyCollectionReducer(t,e):t}).bind(this)}clearCollectionsReducer(t,e){let{collections:s}=e.payload;return s||(s=Object.keys(t)),s.reduce((t,s)=>this.applyCollectionReducer(t,{type:`[${s}] ${e.type}`,payload:{entityName:s,entityOp:"@ngrx/data/remove-all"}}),t)}loadCollectionsReducer(t,e){const{collections:s}=e.payload;return Object.keys(s).reduce((t,r)=>this.applyCollectionReducer(t,{type:`[${r}] ${e.type}`,payload:{entityName:r,entityOp:"@ngrx/data/add-all",data:s[r]}}),t)}mergeQuerySetReducer(t,e){let{mergeStrategy:s,querySet:r}=e.payload;return s=null===s?T.PreserveChanges:s,Object.keys(r).reduce((t,a)=>this.applyCollectionReducer(t,{type:`[${a}] ${e.type}`,payload:{entityName:a,entityOp:"@ngrx/data/upsert-many",data:r[a],mergeStrategy:s}}),t)}saveEntitiesReducer(t,e){const{changeSet:s,correlationId:r,isOptimistic:a,mergeStrategy:n,tag:i}=e.payload;try{s.changes.forEach(s=>{const o=s.entityName,h={entityName:o,entityOp:c(s),data:s.entities,correlationId:r,isOptimistic:a,mergeStrategy:n,tag:i},d={type:`[${o}] ${e.type}`,payload:h};if(t=this.applyCollectionReducer(t,d),d.payload.error)throw d.payload.error})}catch(o){e.payload.error=o}return t;function c(t){switch(t.op){case"Add":return"@ngrx/data/save/add-many";case"Delete":return"@ngrx/data/save/delete-many";case"Update":return"@ngrx/data/save/update-many";case"Upsert":return"@ngrx/data/save/upsert-many"}}}saveEntitiesCancelReducer(t,e){return this.clearLoadingFlags(t,e.payload.entityNames||[])}saveEntitiesErrorReducer(t,e){const s=e.payload.originalAction.payload.changeSet.changes.map(t=>t.entityName);return this.clearLoadingFlags(t,s)}saveEntitiesSuccessReducer(t,e){const{changeSet:s,correlationId:r,isOptimistic:a,mergeStrategy:n,tag:i}=e.payload;return s.changes.forEach(s=>{const o=s.entityName,h={entityName:o,entityOp:c(s),data:s.entities,correlationId:r,isOptimistic:a,mergeStrategy:n,tag:i};t=this.applyCollectionReducer(t,{type:`[${o}] ${e.type}`,payload:h})}),t;function c(t){switch(t.op){case"Add":return"@ngrx/data/save/add-many/success";case"Delete":return"@ngrx/data/save/delete-many/success";case"Update":return"@ngrx/data/save/update-many/success";case"Upsert":return"@ngrx/data/save/upsert-many/success"}}}applyCollectionReducer(t={},e){const s=e.payload.entityName,r=t[s],a=this.entityCollectionReducerRegistry.getOrCreateReducer(s);let n;try{n=a(r||this.entityCollectionCreator.create(s),e)}catch(i){this.logger.error(i),e.payload.error=i}return e.payload.error||r===n?t:Object.assign(Object.assign({},t),{[s]:n})}clearLoadingFlags(t,e){let s=!1;return e.forEach(e=>{const r=t[e];r.loading&&(s||(t=Object.assign({},t),s=!0),t[e]=Object.assign(Object.assign({},r),{loading:!1}))}),t}}return t.\u0275fac=function(e){return new(e||t)(r.gc(Et),r.gc(Ft),r.gc(W))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})(),Bt=(()=>{class t{error(t,e){t&&(e?console.error(t,e):console.error(t))}log(t,e){t&&(e?console.log(t,e):console.log(t))}warn(t,e){t&&(e?console.warn(t,e):console.warn(t))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})();const qt=["equipment","information","money","series"];let Kt=(()=>{class t{constructor(t){this.pluralNames={},t&&t.forEach(t=>this.registerPluralNames(t))}pluralize(t){return this.pluralNames[t]||(qt.indexOf(t.toLowerCase())>=0?t:/[aeiou]y$/.test(t)?t+"s":t.endsWith("y")?t.substr(0,t.length-1)+"ies":/[s|ss|sh|ch|x|z]$/.test(t)?t+"es":t+"s")}registerPluralNames(t){this.pluralNames=Object.assign(Object.assign({},this.pluralNames),t||{})}}return t.\u0275fac=function(e){return new(e||t)(r.gc(X,8))},t.\u0275prov=r.Ob({token:t,factory:t.\u0275fac}),t})(),Pt=(()=>{class t{constructor(t,e,s,a,n,i){this.reducerManager=t,this.injector=s,this.entityCacheName=a,this.initialState=n,this.metaReducers=i;const c=a||"entityCache";n="function"==typeof n?n():n;const o=(i||[]).map(t=>t instanceof r.r?s.get(t):t);this.entityCacheFeature={key:c,reducers:e.create(),reducerFactory:v.n,initialState:n||{},metaReducers:o},t.addFeature(this.entityCacheFeature)}static forRoot(e){return{ngModule:t,providers:[{provide:ut,useValue:e.entityCacheMetaReducers?e.entityCacheMetaReducers:[]},{provide:yt,useValue:e.entityCollectionMetaReducers?e.entityCollectionMetaReducers:[]},{provide:X,multi:!0,useValue:e.pluralNames?e.pluralNames:{}}]}}ngOnDestroy(){this.reducerManager.removeFeature(this.entityCacheFeature)}}return t.\u0275mod=r.Qb({type:t}),t.\u0275inj=r.Pb({factory:function(e){return new(e||t)(r.gc(v.d),r.gc(Lt),r.gc(r.s),r.gc(lt,8),r.gc(gt,8),r.gc(ut,8))},providers:[it,ct,A,ht,Lt,Ot,Et,Rt,Nt,Ft,kt,Dt,et,ft,xt,At,Mt,{provide:lt,useValue:"entityCache"},{provide:Ut,useClass:wt},{provide:W,useClass:Bt}],imports:[[v.k]]}),t})(),Qt=(()=>{class t{constructor(t,e,s){this.effectSources=t,this.addEffects(e),this.addEffects(s)}static forRoot(e){return{ngModule:t,providers:[{provide:tt,multi:!0,useValue:e.entityMetadata?e.entityMetadata:[]},{provide:ut,useValue:e.entityCacheMetaReducers?e.entityCacheMetaReducers:[]},{provide:yt,useValue:e.entityCollectionMetaReducers?e.entityCollectionMetaReducers:[]},{provide:X,multi:!0,useValue:e.pluralNames?e.pluralNames:{}}]}}addEffects(t){this.effectSources.addEffects(t)}}return t.\u0275mod=r.Qb({type:t}),t.\u0275inj=r.Pb({factory:function(e){return new(e||t)(r.gc(x.b),r.gc(vt),r.gc(jt))},providers:[_,st,rt,vt,jt,{provide:J,useClass:Z},{provide:at,useClass:nt},{provide:z,useClass:Kt}],imports:[[Pt,x.c]]}),t})()},MQ3N:function(t,e,s){"use strict";s.d(e,"a",(function(){return O}));var r=s("ofXK"),a=s("aceb"),n=s("9urI"),i=s("3Pt+"),c=s("G5s2"),o=s("74Do"),h=s("fXoL");let d=(()=>{class t extends c.a{constructor(t){super(t),this.customPluralizer=t}getResourceUrls(t,e){let s=this.knownHttpResourceUrls[t];if(!s){const e=`/${this.customPluralizer.pluralize(t)}/`.toLowerCase();s={entityResourceUrl:e,collectionResourceUrl:e},this.registerHttpResourceUrls({[t]:s})}return s}}return t.\u0275fac=function(e){return new(e||t)(h.gc(c.f))},t.\u0275prov=h.Ob({token:t,factory:t.\u0275fac}),t})();var l=s("xbZg"),u=s("m1XX"),y=s("8ikL");let g=(()=>{class t extends c.b{constructor(t){super("DeliveryMan",t)}}return t.\u0275fac=function(e){return new(e||t)(h.gc(c.c))},t.\u0275prov=h.Ob({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const p={entityMetadata:{Order:{},Company:{},DeliveryMan:{}},pluralNames:{Order:"Orders",Company:"Companies",DeliveryMan:"DeliveryMen"}};let O=(()=>{class t{}return t.\u0275mod=h.Qb({type:t}),t.\u0275inj=h.Pb({factory:function(e){return new(e||t)},providers:[o.a,y.a,g,{provide:c.e,useClass:d},l.a],imports:[[r.c,a.u,a.n,a.l,n.a,a.E,i.A,a.X,a.j,c.d.forRoot(p),u.b]]}),t})()},xbZg:function(t,e,s){"use strict";s.d(e,"a",(function(){return i}));var r=s("Oh6O"),a=s("fXoL"),n=s("sYmb");let i=(()=>{class t{constructor(t){this.translate=t,this.status={inProgress:{label:"En cours",color:"warning"},created:{label:"Cr\xe9\xe9e",color:"primary"},shipping:{label:"En livraison",color:"info"},delivered:{label:"Livr\xe9e",color:"success"},canceled:{label:"Annul\xe9e",color:"danger"}},this.communSettings={mode:"external",attr:{class:"orders-table"}}}mapApiData(t){const e=new r.f;return t.map(t=>({id:t.id,fullName:t.customer.firstName+" "+t.customer.lastName,phoneNumber:t.customer.phoneNumber,city:t.customer.address.city,price:e.transform(t.totalCost),status:this.getStatusHTML(t.status)}))}getSellerSettings(t){return Object.assign(Object.assign({actions:{position:"right",custom:[{name:"previewAction",title:'<i class="eva eva-eye-outline text-black-50"></i>'},{name:"editAction",title:'<i class="eva eva-edit-outline text-info"></i>'},{name:"deleteAction",title:'<i class="eva eva-trash-2-outline text-danger"></i>'}],add:!1,edit:!1,delete:!1}},this.communSettings),{columns:t})}getStatusHTML(t){return`<span class="status-tag status-tag-inline status-tag-pill status-tag-light-${this.status[t].color}">${this.translate.instant(t)} </span>`}get statusFilterList(){return Object.keys(this.status).map(t=>({value:this.status[t].label,title:this.status[t].label}))}}return t.\u0275fac=function(e){return new(e||t)(a.gc(n.d))},t.\u0275prov=a.Ob({token:t,factory:t.\u0275fac}),t})()}}]);